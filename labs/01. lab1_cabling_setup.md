## Lab 1: Physical Cabling and Rack Setup

Less of a traditional “lab” and more of an actual necessity for me to power on, connect, and be able to configure my Cisco switches and routers.  This beginning step is what is needed for me to configure devices and create a topology to mimic real-world networks.

<center>
  <img width="400" height="500" alt="homelab" class="center" src="https://github.com/user-attachments/assets/3cb35778-72e6-4fe5-be0a-ed7a7a70aadf" />
</center>

To start this, I needed to understand what type of topology I needed; most networks today use a three-tier approach:

1. **Core**
2. **Distribution**
3. **Access**

<center>
  <img width="400" height="400" alt="three_tier" class="center" src="https://github.com/user-attachments/assets/5d4fae70-06e7-4f28-8e58-a71776819e6d" />
</center>

- **Core Layer** - Being the core of the network (the backbone), where L3 switches and routers typically help with the forwarding of IP traffic.
- **Distribution Layer** - This is where L3 devices, like L3 switches and routers, distribute data to end hosts.
- **Access Layer** - Where users get plugged into L2 switches, and it’s the closest layer that interacts more with end hosts.

For my topology, I decided to go with the “Collapsed Core”, where the two-tier approach is:

1. **Core**
2. **Access**

<center>
  <img width="875" height="280" alt="collapsed_core" class="center" src="https://github.com/user-attachments/assets/ef00b30b-1aa4-4a57-a4d5-2201ec2f053b" />
</center>

- I ended up choosing this topology approach because it reflects the three-tier approach (aside from the distribution layer), but it was practical enough with the 6 devices that I have.

Now that I have the idea of my topology, I need to expand that to my devices:

- `Cisco 1921 Routers (x3)`
- `Cisco Catalyst 2960 Switches (x2)`
- `Cisco Catalyst 3560 Switch (x1)`
- `My personal Windows 10 PC`

Since these Cisco devices all have Auto-MDIX, I won’t have to worry about having both straight-through and crossover cables. Here are the cables I have to work with my homelab setup:

- `Ethernet UTP Straight-Through Cables (x10)`
- `Rollover Cable (x1)`
- `6 FT PC-AC Outlet 15 Amp Power Cord 5-15P to C13 (x6)`
- `8-Socketed Power Strip (x1)`

My thought process was that I’ll use my L3 Cisco 3560 Switch as my “Core” device, and link my L2 Cisco 2960 switches off of it. After that, I’ll connect my 1921 routers off the core as well. Which ended up looking something like this:

### Cabling Map
```
SW1 Fa0/1 ←→ SW2 Fa0/1
SW1 Fa0/2 ←→ SW3 Fa0/1
SW1 Fa0/3 ←→ PC Ethernet NIC
SW1 Fa0/4 ←→ R1 Gi0/1
SW1 Fa0/5 ←→ R2 Gi0/1
SW1 Fa0/6 ←→ R3 Gi0/1
```

This is what I have for my “Core” tier:

- `L3 Cisco 3560 Switch (x1)`

And then my “Access” tier:

- `Cisco 1921 Routers (x3)`
- `Cisco Catalyst 2960 Switches (x2)`

Eventually, I’ll have to move my cabling around when it comes to routing my routers with static and dynamic routing, but this will be fine for the time being, just to be able to console in and start configuring everything. 

I got everything set up and powered on, and working!

<center>
  <img width="400" height="500" alt="connected_homelab" class="center" src="https://github.com/user-attachments/assets/1fb748ed-bf60-42a5-a3b0-7711b4a28ed6" />
</center>

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
`08/07/2025 Update`

## Update to Design

In the last lab, I learned about Inter-VLAN routing, where we connected a Windows 10 VM (Fa0/5) and an Ubuntu VM (Fa0/6) on switch SW1. All well and good for that understanding, but we need to keep in mind our two-layer topology (core/distribution layer and the access layer). For that, I ended up adding some fiber connections to the switches, which should help:

<center>
  <img width="400" height="500" alt="connected_homelab" class="center" src="https://github.com/user-attachments/assets/4c5428bf-32c9-4629-b1c8-ef32c4487798" />
</center>

We’ll remove those connections of the VMs on SW1 and move them to our access layers, SW2 and SW3, in this case. To make it more realistic, let’s put one host on each Access switch. So, it will look like:

- `Ubuntu VM on SW2 Fa0/3`
- `Windows VM on SW3 Fa0/3`

We’ll make sure that they’re trunked between SW1 and SW2/SW3, with this configuration on the fiber connections for Gi0/1 and Gi0/2 on SW1:

```python
conf t
!
interface Gi0/1
	description Fiber Downlink to SW2
	switchport trunk encapsulation dot1q
	switchport mode trunk
	switchport trunk allowed vlan 10
exit
!
interface Gi0/2
	description Fiber Downlink to SW3
	switchport trunk encapsulation dot1q
	switchport mode trunk
	switchport trunk allowed vlan 20
exit
!
end
wr
```

On top of this, we’ll keep the interface VLANs (VLAN10 and VLAN 20) on SW1 just the same, so Inter-VLAN routing with the SVIs isn’t changed:

```python
interface Vlan10
description Sales (SVI to Ubuntu VM)
ip address 192.168.10.1 255.255.255.0
!
interface Vlan20
description HR (SVI to Win10 VM)
ip address 192.168.20.1 255.255.255.0
```

So our official updated network topology should be this now:

Device	Interface	Connected To	VLAN	Role
SW2 Fa0/3	Ubuntu VM	Host	10	Access
SW2 Gi0/1	SW1 Gi0/1	Trunk	10	Trunk to SW1
SW3 Fa0/3	Win10 VM	Host	20	Access
SW3 Gi0/1	SW1 Gi0/2	Trunk	20	Trunk to SW1
SW2 Gi0/2	SW3 Gi0/2	Trunk	-	Trunk between SW2 and SW3

| Device | Interface | Connected To | VLAN | Role |
| --- | --- | --- | --- | --- |
| SW2 Fa0/3 | Ubuntu VM | Host | 10 | Access |
| SW2 Gi0/1 | SW1 Gi0/1 | Trunk | 10 | Trunk to SW1 |
| SW3 Fa0/3 | Win10 VM | Host | 20 | Access |
| SW3 Gi0/1 | SW1 Gi0/2 | Trunk | 20 | Trunk to SW1|
| SW2 Gi0/2 | SW3 Gi0/2 | Trunk | - | Trunk between SW2 and SW3 |

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
`08/28/2025 Update`

## Update to the Topology

When I was working on the IPv6 routing lab, I encountered an issue where OSPFv2 and OSPFv3 weren’t functioning between SW1 and R1’s P2P interfaces. Let me show you:

**SW1**

```bash
interface Vlan99
description Management for connected ports (Fa0/3-Fa0/4)
ip address 192.168.1.1 255.255.255.0
ip ospf authentication message-digest
ip ospf message-digest-key 1 md5 S3cureOSPF!
ipv6 address FD00:1:0:1::1/64
ipv6 enable
ipv6 ospf 1 area 0
end
```

```bash
SW1#show ipv6 route ospf
IPv6 Routing Table - default - 5 entries
Codes: C - Connected, L - Local, S - Static, U - Per-user Static route
B - BGP, R - RIP, D - EIGRP, EX - EIGRP external
ND - ND Default, NDp - ND Prefix, DCE - Destination, NDr - Redirect
O - OSPF Intra, OI - OSPF Inter, OE1 - OSPF ext 1, OE2 - OSPF ext 2
ON1 - OSPF NSSA ext 1, ON2 - OSPF NSSA ext 2
O   FD00:1:0:3::/64 [110/2]
via FE80::A2E0:AFFF:FEA9:9F01, Vlan99
O   FD00:1:0:5::/64 [110/3]
via FE80::A2E0:AFFF:FEA9:9F01, Vlan99
```

- As you can see, on Vlan99, you can see:
    1. IPV6 `FD00:1:0:1::1/64` has been added with `ipv6 enable` command.
    2. OSPFv3 has been added with command `ipv6 ospf 1 area 0` .
- Lastly, you can see that OSPv3 is being picked up with `show ipv6 route ospf` on VLAN99.

However, look at the router:

**R1**

```bash
interface GigabitEthernet0/1
description Uplink to SW1 Fa0/4 (Management VLAN 99)
ip address 192.168.1.2 255.255.255.0
ip ospf authentication message-digest
ip ospf message-digest-key 1 md5 S3cureOSPF!
duplex auto
speed auto
ipv6 address FD00:1:0:1::2/64
ipv6 enable
ipv6 ospf 1 area 0
end
```

```bash
R1#show ipv6 route ospf
IPv6 Routing Table - default - 7 entries
Codes: C - Connected, L - Local, S - Static, U - Per-user Static route
B - BGP, HA - Home Agent, MR - Mobile Router, R - RIP
H - NHRP, I1 - ISIS L1, I2 - ISIS L2, IA - ISIS interarea
IS - ISIS summary, D - EIGRP, EX - EIGRP external, NM - NEMO
ND - ND Default, NDp - ND Prefix, DCE - Destination, NDr - Redirect
O - OSPF Intra, OI - OSPF Inter, OE1 - OSPF ext 1, OE2 - OSPF ext 2
ON1 - OSPF NSSA ext 1, ON2 - OSPF NSSA ext 2, la - LISP alt
lr - LISP site-registrations, ld - LISP dyn-eid, lA - LISP away
a - Application
O   FD00:1:0:5::/64 [110/2]
via FE80::262:ECFF:FEFF:C9A1, GigabitEthernet0/0
```

- Everything is configured similarly on R1’s G0/1:
    1. IPV6 `FD00:1:0:1::2/64` has been added with `ipv6 enable` command
    2. OSPFv3 has been added with command `ipv6 ospf 1 area 0`
- Now, look at the output of the  `show ipv6 route ospf` command: it isn’t showing an OSPFv3 route for Gi0/1, only Gi0/0.

### The Problem

Here’s the Problem, 

- On SW1, we have our management VLAN99 that currently has OSPFv2, but we can’t have OSPFv3 on the same link.
- This is because OSPFv3 neighbors only form on interfaces that are Layer 3 and aren’t acting like a switchport for Layer 2 traffic.
- For a Layer 2 SVI, OSPFv3 won’t form if there’s no active “routered” connection on the SVI.

**So, OSPFv3 sees the CVI as inactive for OSPFv3 purposes.**

We also can’t use any other interfaces on R1 because if we want to keep OSPFv2, which I do, then we also have a physical limitation, since R1 only has two Ethernet ports and no fiber connections. 

### The Solution

Given the constraints of the hardware limitations in the Cisco 3560 Catalyst (classic) switch, the only option now is to upgrade to a new L3 core switch, so we can then **dual-stack** OSPFv2 and OSPFv3 on VLAN99 without this issue.

<center>
  <img width="400" height="500" alt="new_3560v2_switch" class="center" src="https://github.com/user-attachments/assets/f7569553-778b-4b4a-9313-86cecd413669" />
</center>

- This is a Cisco Catalyst 3560 v2 24 Port Ethernet Switch 370W PoE (WS-C3560V2-24PS-S)

With this newer 3560, we should now be able to run the dual-stack for IPv6 routing, as well as use it for Wireless with the PoE for the wireless controller (WLC). We get the benefits of completing two labs, one that wasn’t possible before, and keeping the topology clean.

I’ll probably try and sell the classic 3560 or give it away to someone else studying for the CCNA.

### The Migration

Now that we have the new device, we need to:

1. **Save Configuration from the 3560C**
2. **Stage the New 3560V2**
3. **Add the Configuration from 3560C to 3560V2**
4. **Physically Swap Devices**
5. **Verify**

Let’s take a look at each step and migrate this configuration correctly

**Save Configuration from the 3560C**

First, let’s prepare the work by saving all the current configuration to a text file, in case I need it for ease of reference. Here are the commands we’ll run:

```bash
show running-config
show vlan brief
show ip interface brief
show ipv6 interface brief
show ip route
show ipv6 route
show cdp neighbors
show sdm prefer
```

- I’m going to save the startup config for my baseline
- We’ll also verify the SDM for the current features on the 3560C (OSPFv2, SVIs, VLANs, port security, DHCP pools, etc.)

Once we have everything saved, let’s get the new device up and running to wipe the hard drive.

**Stage the New 3560V2**

With the power cable and console cable (rollover) plugged in,  get through the initial device settings and wipe any existing configuration with:

```bash
write erase
reload
```

Next, let’s check the SDM template for dual stack before applying any configuration:

```bash
show sdm prefer
```

- In my case, it says “desktop default”; now we want to apply dual stack.

```bash
conf t
!
sdm prefer dual-ipv4-and-ipv6 default
!
end

reload
```

- Verify SDM after reload is completed. In my case, it now says "desktop IPv4 and IPv6 default” after reloading.

Next, we’re going to configure the 3550v2 with the 3650C configuration. 

**Add the Configuration from 3560C to 3560V2**

With everything set up, we’re going to configure the new 3560v2 with the configuration from my 3560C with this massive configuration paste:

```bash
conf t
!
! ================== GLOBAL ==================
version 15.0
no service pad
service timestamps debug datetime msec
service timestamps log datetime msec
no service password-encryption
!
hostname SW1
!
ip routing
ip domain-name homelab.local
ipv6 unicast-routing
!
enable secret 5 $1$gpFY$E/p2EC4.uoDK4h3B3XRfO.
username dan secret 5 $1$gCmc$8YvhDKu8a//2quiCD.vU11
no aaa new-model
system mtu routing 1500
ip ssh version 2
!
ip scp server enable
!
! ---- DHCP (unchanged) ----
ip dhcp excluded-address 192.168.10.1 192.168.10.10
ip dhcp pool VLAN10-POOL
 network 192.168.10.0 255.255.255.0
 default-router 192.168.10.1
 dns-server 8.8.8.8
!
ip dhcp pool VLAN20-POOL
 network 192.168.20.0 255.255.255.0
 default-router 192.168.20.1
 dns-server 8.8.8.8
!
! ---- OSPFv2 auth key (unchanged) ----
key chain OSPF_KEYS
 key 1
  key-string S3cureOSPF!
!
! ---- STP (unchanged) ----
spanning-tree mode rapid-pvst
spanning-tree extend system-id
spanning-tree vlan 99 priority 24576
!
vlan internal allocation policy ascending
!
! ================== VLANS ==================
vlan 10
 name SALES
vlan 20
 name HR
vlan 99
 name MGMT
!
! ================== INTERFACES ==================
interface Loopback0
 description OSPFv2/General RID anchor (IPv4)
 no ip address
!
interface Loopback99
 description IPv6 loopback for reachability/RID demo
 ipv6 address FD00:1:0:99::1/128
 ipv6 ospf 1 area 0
!
! --- L2 uplinks to SW2 / SW3 ---
interface FastEthernet0/1
 description Downlink to SW2 Fa0/1
 switchport trunk native vlan 99
 switchport mode trunk
 spanning-tree guard root
!
interface FastEthernet0/2
 description Downlink to SW3 Fa0/1
 switchport trunk native vlan 99
 switchport mode trunk
 spanning-tree guard root
!
! --- PC Mgmt access (VLAN 99) ---
interface FastEthernet0/3
 description Connection to PC (Management Access - VLAN 99)
 switchport access vlan 99
 switchport mode access
 switchport port-security mac-address sticky
 switchport port-security mac-address sticky 2cf0.5d97.5625
 switchport port-security
 spanning-tree portfast
 spanning-tree bpduguard enable
!
! --- Link to R1 (ACCESS to VLAN 99) ---
interface FastEthernet0/4
 description Downlink to R1 Gi0/1 (VLAN 99)
 switchport access vlan 99
 switchport mode access
!
! --- Unused access ports (kept shutdown) ---
interface FastEthernet0/5
 description Not in Use
 shutdown
interface FastEthernet0/6
 description Not in Use
 shutdown
interface FastEthernet0/7
 description Not in Use
 shutdown
interface FastEthernet0/8
 description Not in Use
 shutdown
interface FastEthernet0/9
 description Not in Use
 shutdown
interface FastEthernet0/10
 description Not in Use
 shutdown
interface FastEthernet0/11
 description Not in Use
 shutdown
interface FastEthernet0/12
 description Not in Use
 shutdown
interface FastEthernet0/13
 description Not in Use
 shutdown
interface FastEthernet0/14
 description Not in Use
 shutdown
interface FastEthernet0/15
 description Not in Use
 shutdown
interface FastEthernet0/16
 description Not in Use
 shutdown
interface FastEthernet0/17
 description Not in Use
 shutdown
interface FastEthernet0/18
 description Not in Use
 shutdown
interface FastEthernet0/19
 description Not in Use
 shutdown
interface FastEthernet0/20
 description Not in Use
 shutdown
interface FastEthernet0/21
 description Not in Use
 shutdown
interface FastEthernet0/22
 description Not in Use
 shutdown
interface FastEthernet0/23
 description Not in Use
 shutdown
interface FastEthernet0/24
 description Not in Use
 shutdown
!
! --- Fiber trunks to SW2/SW3 (single VLAN each) ---
interface GigabitEthernet0/1
 description Fiber Downlink to SW2 Gi0/1
 switchport trunk encapsulation dot1q
 switchport trunk allowed vlan 10
 switchport mode trunk
!
interface GigabitEthernet0/2
 description Fiber Downlink to SW3 Gi0/1
 switchport trunk encapsulation dot1q
 switchport trunk allowed vlan 20
 switchport mode trunk
!
! --- SVIs ---
interface Vlan1
 description Not in Use
 no ip address
 shutdown
!
interface Vlan10
 description Sales (SVI to Ubuntu VM)
 ip address 192.168.10.1 255.255.255.0
 ipv6 address FD00:1:0:10::1/64
 ipv6 enable
 ipv6 ospf 1 area 0
!
interface Vlan20
 description HR (SVI to Win10 VM)
 ip address 192.168.20.1 255.255.255.0
 ipv6 address FD00:1:0:20::1/64
 ipv6 enable
 ipv6 ospf 1 area 0
!
interface Vlan99
 description Transit/Management (to R1 + mgmt hosts)
 ip address 192.168.1.1 255.255.255.0
 ip ospf authentication message-digest
 ip ospf message-digest-key 1 md5 S3cureOSPF!
 ip ospf 1 area 0
 ipv6 address FD00:1:0:1::1/64
 ipv6 enable
 ipv6 ospf 1 area 0
!
! ================== ROUTING ==================
router ospf 1
 router-id 192.168.1.1
 auto-cost reference-bandwidth 1000
 area 0 authentication message-digest
 passive-interface Vlan10
 passive-interface Vlan20
 network 192.168.1.0 0.0.0.255 area 0
 network 192.168.10.0 0.0.0.255 area 0
 network 192.168.20.0 0.0.0.255 area 0
!
ipv6 router ospf 1
 router-id 192.168.1.1
 passive-interface Loopback99
 passive-interface Vlan10
 passive-interface Vlan20
 no passive-interface Vlan99
!
! ================== MGMT ==================
no ip http server
no ip http secure-server
!
line con 0
 exec-timeout 15 0
line vty 0 4
 login local
 transport input ssh
 exec-timeout 15 0
line vty 5 15
 login local
 transport input ssh
 exec-timeout 15 0
!
end
wr

```

- I did run into an issue with the 3560v2, where the IPServices weren’t showing up. I guess the device only had the regular IP base config, so after a long arduous process, I stripped the IPServices from my 3560C and placed it on my 3650v2

After configuring everything, let’s also physically swap out the devices!

**Physically Swap Devices**

Look at this back-to-back view of the switch between devices:

<center>
  <img width="400" height="500" alt="old_3560C" class="center" src="https://github.com/user-attachments/assets/818f602f-7ee7-4d88-9e75-24a813e4b3fd" />
</center>

<center>
  <img width="400" height="500" alt="new_3560v2" class="center" src="https://github.com/user-attachments/assets/c164b67c-2d92-4110-97df-834be3a052ed" />
</center>

- Swapping them was really easy, I just had to:
    1. Pull out the Ethernet and fiber connections
    2. Remove the 3560C by unscrewing the side screws
    3. Remove the rack mount ears from the 3560C
    4. Add the rack mounts to the 3560v2
    5. Place the screws on the rack mount for the 3560v2
    6. Add the Ethernet and fiber connections

Ultimately, the physical topology didn’t change, only the L3 switch:

- `SW1 (3560V2) Fa0/1 ←→ SW2 Fa0/1` (trunk, native 99; VLAN 10 allowed)
- `SW1 (3560V2) Fa0/2 ←→ SW3 Fa0/1` (trunk, native 99; VLAN 20 allowed)
- `SW1 (3560V2) Fa0/3 ←→ PC NIC` (access VLAN 99)
- `SW1 (3560V2) Fa0/4 ←→ R1 Gi0/1` (access VLAN 99)
- `R1 Gi0/0 ←→ R2 Gi0/1` (P2P)

After that, everything was up and running! Lastly, we had to make sure we did all of the show commands and verify that the output is the same on the new 3560v2
**Verify**

We’ll run the same commands as we did before the migration on the 3560C, but this time on the new 3560v2:

```bash
show running-config
show vlan brief
show ip interface brief
show ipv6 interface brief
show ip route
show ipv6 route
show cdp neighbors
show sdm prefer
```

Everything came back perfect! We migrated the device to the best of our ability, and we nailed it.
